# API Reference

## Core Functions

### Inspect

```go
func Inspect[T any]() ModelMetadata
```

Extracts metadata for a single type. Results are cached permanently.

**Panics** if `T` is not a struct type.

```go
metadata := sentinel.Inspect[User]()
```

### Scan

```go
func Scan[T any]() ModelMetadata
```

Recursively extracts metadata for a type and all related types within the same module.

**Panics** if `T` is not a struct type.

```go
metadata := sentinel.Scan[User]()
// User and all related types (Profile, Order, etc.) are now cached
```

### Tag

```go
func Tag(tagName string)
```

Registers a custom struct tag for extraction. Call before `Inspect` or `Scan`.

```go
sentinel.Tag("graphql")
sentinel.Tag("proto")
```

### Browse

```go
func Browse() []string
```

Returns all cached type names.

```go
names := sentinel.Browse()
// ["User", "Profile", "Order"]
```

### Lookup

```go
func Lookup(typeName string) (ModelMetadata, bool)
```

Retrieves cached metadata by type name.

```go
meta, ok := sentinel.Lookup("User")
if ok {
    // Use meta
}
```

### Schema

```go
func Schema() map[string]ModelMetadata
```

Returns all cached metadata as a map.

```go
schema := sentinel.Schema()
for name, meta := range schema {
    fmt.Printf("%s: %d fields\n", name, len(meta.Fields))
}
```

## Relationship Functions

### GetRelationships

```go
func GetRelationships[T any]() []TypeRelationship
```

Returns all types that `T` references.

```go
rels := sentinel.GetRelationships[User]()
// [{From: "User", To: "Profile", Kind: "reference", ...}]
```

### GetReferencedBy

```go
func GetReferencedBy[T any]() []TypeRelationship
```

Returns all types that reference `T`. Requires prior caching of those types.

```go
refs := sentinel.GetReferencedBy[Profile]()
// [{From: "User", To: "Profile", Kind: "reference", ...}]
```


## Types

### ModelMetadata

```go
type ModelMetadata struct {
    TypeName      string             `json:"type_name"`
    PackageName   string             `json:"package_name"`
    Fields        []FieldMetadata    `json:"fields"`
    Relationships []TypeRelationship `json:"relationships,omitempty"`
}
```

### FieldMetadata

```go
type FieldMetadata struct {
    Name string            `json:"name"`
    Type string            `json:"type"`
    Tags map[string]string `json:"tags,omitempty"`
}
```

### TypeRelationship

```go
type TypeRelationship struct {
    From      string `json:"from"`       // Source type name
    To        string `json:"to"`         // Target type name
    Field     string `json:"field"`      // Field creating the relationship
    Kind      string `json:"kind"`       // "reference", "collection", "embedding", "map"
    ToPackage string `json:"to_package"` // Target type's package path
}
```

## Relationship Kinds

| Kind | Description | Example |
|------|-------------|---------|
| `reference` | Direct struct or pointer | `Profile *Profile` |
| `collection` | Slice or array | `Orders []Order` |
| `embedding` | Anonymous field | `BaseModel` |
| `map` | Map with struct values | `Items map[string]Item` |
