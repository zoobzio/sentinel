---
title: Automatic API Documentation
description: Generate OpenAPI specifications from Go types
author: zoobzio
published: 2025-12-30
updated: 2025-12-30
tags:
  - Cookbook
  - OpenAPI
  - Documentation
---

# Automatic API Documentation

Generate OpenAPI specifications from your Go types using sentinel and [rocco](https://github.com/zoobzio/rocco).

## The Problem

API documentation drifts. You update a handler, forget to update the spec, and clients break. Manual OpenAPI maintenance doesn't scale.

## The Solution

Your types *are* your documentation:

```go
type CreateUserRequest struct {
    Name  string `json:"name" validate:"required,min=3,max=100" description:"User's full name"`
    Email string `json:"email" validate:"required,email" description:"Contact email"`
    Age   int    `json:"age,omitempty" validate:"gte=0,lte=150"`
}
```

Register a handler:

```go
rocco.NewHandler[CreateUserRequest, User](
    "create-user", "POST", "/users",
    func(req *rocco.Request[CreateUserRequest]) (User, error) {
        // ...
    },
)
```

Get complete OpenAPI:

```json
{
  "type": "object",
  "required": ["name", "email"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 3,
      "maxLength": 100,
      "description": "User's full name"
    },
    "email": {
      "type": "string",
      "format": "email",
      "description": "Contact email"
    },
    "age": {
      "type": "integer",
      "minimum": 0,
      "maximum": 150
    }
  }
}
```

No manual spec writing. Change the struct, the docs update.

## How Sentinel Enables This

When you register a handler, rocco calls sentinel:

```go
sentinel.Scan[CreateUserRequest]()  // Extract input type + related types
sentinel.Scan[User]()               // Extract output type + related types
```

Later, when generating OpenAPI:

```go
meta, _ := sentinel.Lookup("CreateUserRequest")

for _, field := range meta.Fields {
    // field.Tags["validate"] → OpenAPI constraints
    // field.Tags["description"] → schema description
    // field.Tags["example"] → example values
    // field.Type → OpenAPI type mapping
}
```

Sentinel caches all type metadata. Rocco transforms it to [openapi](https://github.com/zoobzio/openapi) schemas.

## Tag Mappings

Your validation rules become OpenAPI constraints:

| Validate Tag | OpenAPI |
|--------------|---------|
| `required` | field in `required` array |
| `min=3` | `minLength: 3` (strings) or `minimum: 3` (numbers) |
| `max=100` | `maxLength: 100` or `maximum: 100` |
| `email` | `format: "email"` |
| `url` | `format: "uri"` |
| `uuid` | `format: "uuid"` |
| `oneof=a b c` | `enum: ["a", "b", "c"]` |

Documentation tags map directly:

| Tag | OpenAPI |
|-----|---------|
| `description:"..."` | `description` |
| `example:"..."` | `example` |

## Nested Types

Sentinel's relationship discovery handles complex types:

```go
type Order struct {
    ID       string    `json:"id"`
    Customer *Customer `json:"customer"`
    Items    []Item    `json:"items"`
}
```

When `Order` is scanned, sentinel discovers `Customer` and `Item` automatically. Rocco includes all three in `components.schemas` with proper `$ref` links.

## The Result

```go
engine := rocco.NewEngine(...)
engine.WithHandlers(createUser, getUser, listUsers, ...)

// Generate complete spec
spec := engine.GenerateOpenAPI(identity)
```

One source of truth. Types define the API. Sentinel extracts the metadata. Rocco generates the docs.

## See Also

- [rocco](https://github.com/zoobzio/rocco) — HTTP framework with OpenAPI generation
- [openapi](https://github.com/zoobzio/openapi) — OpenAPI type definitions
- [Scanning guide](../3.guides/1.scanning.md) — how recursive type discovery works
